<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subir Receta - CoockNet</title>
    <link rel="stylesheet" href="styless.css">
  <style>
        /* Estilos espec√≠ficos para los nuevos controles de la actividad */
        .controls-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 1200px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            align-items: center;
        }

        .search-box {
            flex: 2;
            min-width: 300px;
        }

        .filter-box {
            flex: 1;
            min-width: 200px;
        }

        .form-control-custom {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Estilo para el mensaje de "vac√≠o" */
        .empty-msg {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>üç≥ Subir Nueva Receta</h1>
        
        <form id="recetaForm" enctype="multipart/form-data">
            
            <div class="form-group">
                <label for="nombre">Nombre de la Receta:</label>
                <input type="text" id="nombre" name="nombre" placeholder="Ej: Tacos al Pastor" required>
            </div>

            <div class="form-group">
                <label for="categoria">Categor√≠a:</label>
                <select id="categoria" name="categoria">
                    <option value="Desayuno">Desayuno</option>
                    <option value="Comida">Comida</option>
                    <option value="Cena">Cena</option>
                    <option value="Postre">Postre</option>
                </select>
            </div>

            <div class="form-group">
                <label for="ingredientes">Ingredientes:</label>
                <textarea id="ingredientes" name="ingredientes" rows="4" placeholder="Lista los ingredientes..." required></textarea>
            </div>

            <div class="form-group">
                <label for="instrucciones">Instrucciones/Pasos:</label>
                <textarea id="instrucciones" name="instrucciones" rows="4" placeholder="¬øC√≥mo se prepara?" required></textarea>
            </div>

            <div class="form-group">
                <label for="imagen">Foto de la Receta:</label>
                <input type="file" id="imagen" name="imagen" accept="image/*" required>
            </div>

            <button type="submit">Subir Receta</button>
        </form>

        <div id="mensajeExito" class="mensaje exito"></div>
        <div id="mensajeError" class="mensaje error"></div>
    </div>

    <script>
        const form = document.getElementById('recetaForm');
        const msgExito = document.getElementById('mensajeExito');
        const msgError = document.getElementById('mensajeError');

        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // Evita que la p√°gina se recargue

            // Ocultar mensajes previos
            msgExito.style.display = 'none';
            msgError.style.display = 'none';

            // Crear FormData con los datos del formulario
            const formData = new FormData(form);

            try {
                const response = await fetch('http://localhost:3000/api/recetas', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    // MENSJE DE √âXITO
                    msgExito.innerText = data.message;
                    msgExito.style.display = 'block';
                    form.reset(); // Limpiar formulario
                    
                    // Opcional: Redirigir a la p√°gina principal despu√©s de 2 segundos
                    setTimeout(() => {
                         window.location.href = 'index.html'; 
                    }, 2000);
                } else {
                    // MENSAJE DE ERROR DEL SERVIDOR
                    throw new Error(data.message);
                }

            } catch (error) {
                console.error('Error:', error);
                msgError.innerText = error.message || 'Ocurri√≥ un error al conectar con el servidor.';
                msgError.style.display = 'block';
            }
        });
    </script>
</body>
</html>